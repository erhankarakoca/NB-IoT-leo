clc;
clear;
close all;
startTime = datetime(2024,9,9,7,27,0);
stopTime = datetime(2024,9,9,7,38,0);

dopplerBC = [-44005.1 -43976.5 -43947 -43916.7 -43885.6 -43853.5 -43820.5 -43786.5 -43751.5 -43715.6 -43678.5 -43640.5 -43601.3 -43560.9 -43519.4 -43476.7 -43432.8 -43387.5 -43341 -43293.1 -43243.7 -43192.9 -43140.7 -43086.8 -43031.4 -42974.4 -42915.6 -42855.1 -42792.7 -42728.5 -42662.3 -42594.1 -42523.8 -42451.4 -42376.8 -42299.8 -42220.5 -42138.7 -42054.3 -41967.3 -41877.5 -41784.9 -41689.3 -41590.7 -41488.8 -41383.7 -41275.1 -41163 -41047.1 -40927.5 -40803.8 -40676 -40543.9 -40407.3 -40266 -40119.9 -39968.7 -39812.3 -39650.4 -39482.9 -39309.4 -39129.8 -38943.7 -38751 -38551.3 -38344.4 -38129.9 -37907.5 -37677 -37437.9 -37189.9 -36932.6 -36665.6 -36388.6 -36101.1 -35802.7 -35492.8 -35171.2 -34837.2 -34490.3 -34130.1 -33756 -33367.4 -32963.9 -32544.7 -32109.4 -31657.3 -31187.8 -30700.3 -30194.2 -29668.8 -29123.6 -28557.9 -27971.1 -27362.6 -26731.9 -26078.5 -25401.8 -24701.3 -23976.7 -23227.6 -22453.6 -21654.7 -20830.6 -19981.2 -19106.7 -18207.3 -17283.1 -16334.7 -15362.5 -14367.3 -13349.9 -12311.3 -11252.5 -10174.9 -9079.91 -7969.06 -6844.05 -5706.68 -4558.87 -3402.64 -2240.06 -1073.29 95.4852 1264.07 2430.26 3591.88 4746.79 5892.9 7028.24 8150.9 9259.09 10351.1 11425.5 12480.8 13515.8 14529.4 15520.6 16488.6 17432.8 18352.6 19247.7 20117.7 20962.5 21782.2 22576.7 23346.1 24090.9 24811.1 25507.3 26179.8 26829.1 27455.7 28060.1 28643 29205 29746.5 30268.3 30770.9 31255 31721.2 32170.2 32602.4 33018.6 33419.3 33805 34176.5 34534.1 34878.4 35210 35529.3 35836.8 36133.1 36418.5 36693.4 36958.4 37213.8 37459.9 37697.2 37926.1 38146.7 38359.6 38565 38763.1 38954.4 39139 39317.2 39489.4 39655.6 39816.2 39971.4 40121.4 40266.3 40406.4 40542 40673 40799.8 40922.4 41041.1 41156 41267.2 41374.8 41479.1 41580.1 41677.9 41772.6 41864.4 41953.4 42039.6 42123.2 42204.3 42282.9 42359.1 42433.1 42504.8 42574.4 42641.9 42707.4 42771 42832.7 42892.6 42950.8 43007.2 43062.1 43115.3 43167 43217.2 43266 43313.3 43359.4 43404 43447.5 43489.7 43530.6 43570.5 43609.1 43646.7 43683.2 43718.7 43753.2 43786.7 43819.2 43850.9 43881.6 43911.4 43940.4 43968.6 43995.9 ];

dopplerNE = [-44112.8 -44087.2 -44060.8 -44033.7 -44005.8 -43977 -43947.5 -43917 -43885.7 -43853.5 -43820.3 -43786.2 -43751.1 -43714.9 -43677.7 -43639.5 -43600.1 -43559.5 -43517.8 -43474.9 -43430.8 -43385.3 -43338.5 -43290.3 -43240.7 -43189.7 -43137.1 -43083 -43027.3 -42969.9 -42910.8 -42850 -42787.3 -42722.7 -42656.1 -42587.6 -42516.9 -42444.1 -42369 -42291.6 -42211.7 -42129.4 -42044.5 -41957 -41866.6 -41773.4 -41677.2 -41577.9 -41475.4 -41369.5 -41260.2 -41147.3 -41030.6 -40910.1 -40785.6 -40656.8 -40523.7 -40386.1 -40243.8 -40096.6 -39944.2 -39786.6 -39623.5 -39454.6 -39279.7 -39098.6 -38911 -38716.7 -38515.3 -38306.6 -38090.3 -37866 -37633.3 -37392.1 -37141.8 -36882.2 -36612.8 -36333.2 -36042.9 -35741.6 -35428.8 -35104 -34766.7 -34416.4 -34052.6 -33674.7 -33282.2 -32874.5 -32451.1 -32011.2 -31554.4 -31080 -30587.4 -30075.9 -29545 -28994 -28422.3 -27829.3 -27214.5 -26577.1 -25916.8 -25233 -24525.3 -23793.3 -23036.5 -22254.8 -21447.9 -20615.8 -19758.4 -18875.7 -17968 -17035.7 -16079.1 -15098.8 -14095.7 -13070.4 -12024.2 -10958.1 -9873.5 -8771.83 -7654.72 -6523.88 -5381.17 -4228.56 -3068.08 -1901.84 -732.034 439.149 1609.49 2776.77 3938.82 5093.5 6238.75 7372.59 8493.14 9598.63 10687.4 11758.1 12809.1 13839.4 14847.9 15833.7 16796 17734.1 18647.7 19536.3 20399.7 21237.8 22050.6 22838.2 23600.8 24338.6 25052 25741.4 26407.1 27049.7 27669.8 28267.8 28844.4 29400.1 29935.6 30451.5 30948.3 31426.8 31887.6 32331.2 32758.4 33169.6 33565.4 33946.5 34313.4 34666.7 35006.8 35334.3 35649.7 35953.4 36246 36527.9 36799.4 37061.1 37313.3 37556.4 37790.8 38016.8 38234.7 38444.9 38647.8 38843.5 39032.4 39214.7 39390.7 39560.8 39725 39883.6 40036.9 40185 40328.2 40466.6 40600.5 40729.9 40855.2 40976.4 41093.6 41207.1 41317 41423.3 41526.3 41626.1 41722.7 41816.3 41907 41995 42080.2 42162.8 42242.9 42320.6 42395.9 42469 42539.8 42608.6 42675.3 42740.1 42802.9 42863.9 42923.1 42980.6 43036.4 43090.6 43143.2 43194.3 43243.9 43292.1 43338.9 43384.4 43428.5 43471.4 43513.1 43553.6 43593 43631.2 43668.3 43704.4 43739.5 43773.6 43806.6 43838.8 43870 43900.4];
dopplerNW = [-44061.5 -44033.3 -44004.3 -43974.4 -43943.7 -43912 -43879.4 -43845.9 -43811.4 -43775.9 -43739.3 -43701.7 -43662.9 -43623.1 -43582 -43539.8 -43496.3 -43451.6 -43405.5 -43358.1 -43309.2 -43259 -43207.2 -43153.9 -43098.9 -43042.4 -42984.1 -42924.1 -42862.3 -42798.6 -42732.9 -42665.2 -42595.5 -42523.6 -42449.5 -42373 -42294.2 -42212.9 -42129 -42042.5 -41953.2 -41861.1 -41765.9 -41667.7 -41566.3 -41461.6 -41353.5 -41241.7 -41126.3 -41007 -40883.6 -40756.1 -40624.3 -40487.9 -40346.8 -40200.9 -40049.8 -39893.5 -39731.6 -39564 -39390.5 -39210.7 -39024.4 -38831.3 -38631.2 -38423.8 -38208.7 -37985.6 -37754.2 -37514.2 -37265.1 -37006.5 -36738.2 -36459.6 -36170.3 -35869.9 -35557.9 -35233.8 -34897.1 -34547.3 -34183.9 -33806.3 -33413.9 -33006.1 -32582.4 -32142.2 -31684.7 -31209.5 -30715.7 -30202.9 -29670.3 -29117.3 -28543.3 -27947.6 -27329.7 -26688.9 -26024.7 -25336.6 -24624 -23886.7 -23124.1 -22336 -21522.3 -20682.7 -19817.2 -18926 -18009.1 -17067.1 -16100.2 -15109.1 -14094.6 -13057.6 -11999 -10920.3 -9822.65 -8707.65 -7576.96 -6432.37 -5275.82 -4109.32 -2935 -1755.05 -571.733 612.682 1795.9 2975.64 4149.65 5315.75 6471.81 7615.81 8745.83 9860.08 10956.9 12034.8 13092.3 14128.3 15141.8 16131.8 17097.5 18038.4 18954.1 19844.1 20708.4 21546.7 22359.3 23146.1 23907.5 24643.6 25354.9 26041.9 26704.9 27344.5 27961.3 28555.9 29128.8 29680.7 30212.2 30724 31216.8 31691 32147.5 32586.9 33009.6 33416.5 33808 34184.8 34547.4 34896.3 35232.2 35555.5 35866.8 36166.5 36455 36732.9 37000.6 37258.5 37506.9 37746.3 37977.1 38199.6 38414.1 38620.9 38820.4 39012.9 39198.6 39377.9 39550.9 39718 39879.3 40035.1 40185.7 40331.1 40471.7 40607.6 40739 40866 40988.9 41107.8 41222.8 41334.1 41441.8 41546.1 41647.1 41744.9 41839.6 41931.3 42020.2 42106.3 42189.8 42270.7 42349.2 42425.2 42499 42570.5 42639.8 42707.1 42772.4 42835.8 42897.2 42956.9 43014.8 43071 43125.6 43178.5 43230 43279.9 43328.4 43375.5 43421.2 43465.6 43508.8 43550.7 43591.4 43630.9 43669.3 43706.6 43742.8 43778 43812.2 43845.5 43877.7 43909.1 43939.5 43969.1 43997.8 44025.7 44052.8 44079.1];

dopplerSE = [-43912.5 -43883 -43852.6 -43821.4 -43789.3 -43756.3 -43722.3 -43687.4 -43651.5 -43614.5 -43576.5 -43537.4 -43497.1 -43455.7 -43413.2 -43369.4 -43324.3 -43277.9 -43230.2 -43181.2 -43130.7 -43078.7 -43025.2 -42970.1 -42913.5 -42855.1 -42795.1 -42733.2 -42669.6 -42604 -42536.5 -42466.9 -42395.3 -42321.5 -42245.4 -42167 -42086.2 -42002.9 -41917.1 -41828.6 -41737.3 -41643.1 -41546 -41445.8 -41342.4 -41235.7 -41125.6 -41011.9 -40894.5 -40773.2 -40648 -40518.6 -40384.9 -40246.8 -40103.9 -39956.3 -39803.7 -39645.8 -39482.5 -39313.5 -39138.7 -38957.7 -38770.4 -38576.5 -38375.6 -38167.6 -37952.2 -37728.9 -37497.6 -37257.8 -37009.3 -36751.6 -36484.5 -36207.4 -35920 -35621.9 -35312.7 -34991.9 -34658.9 -34313.5 -33955 -33582.9 -33196.8 -32796.1 -32380.2 -31948.6 -31500.8 -31036 -30553.9 -30053.7 -29534.9 -28997 -28439.3 -27861.3 -27262.4 -26642.1 -26000 -25335.4 -24648.1 -23937.6 -23203.6 -22445.8 -21664 -20858 -20027.9 -19173.7 -18295.5 -17393.6 -16468.4 -15520.3 -14550 -13558.2 -12545.9 -11514.1 -10463.8 -9396.54 -8313.59 -7216.54 -6107.05 -4986.9 -3857.94 -2722.11 -1581.39 -437.831 706.505 1849.55 2989.24 4123.56 5250.5 6368.18 7474.73 8568.42 9647.62 10710.8 11756.6 12783.7 13791 14777.4 15742.2 16684.7 17604.1 18500.1 19372.3 20220.5 21044.5 21844.4 22620.1 23371.9 24099.9 24804.5 25486 26144.8 26781.4 27396.2 27989.7 28562.4 29115 29647.9 30161.8 30657.3 31134.9 31595.1 32038.7 32466.1 32877.9 33274.8 33657.1 34025.5 34380.4 34722.5 35052.1 35369.7 35675.9 35971 36255.5 36529.8 36794.3 37049.4 37295.4 37532.7 37761.7 37982.7 38196 38401.9 38600.6 38792.6 38978 39157.1 39330.1 39497.3 39659 39815.2 39966.3 40112.4 40253.7 40390.4 40522.6 40650.7 40774.6 40894.5 41010.6 41123.1 41232.1 41337.6 41439.8 41538.9 41635 41728 41818.3 41905.8 41990.7 42073 42152.8 42230.3 42305.4 42378.4 42449.1 42517.8 42584.5 42649.3 42712.1 42773.2 42832.5 42890 42946 43000.3 43053 43104.3 43154.1 43202.5 43249.5 43295.2 43339.6 43382.8 43424.7 43465.5 43505.1 43543.6 43581 43617.4 43652.7 43687.1 43720.5 43752.9 43784.4 43815.1 43844.9 43873.8];
dopplerSW = [-43885.2 -43853.3 -43820.4 -43786.6 -43751.8 -43715.9 -43679.1 -43641.2 -43602.2 -43562 -43520.7 -43478.2 -43434.4 -43389.4 -43343.1 -43295.4 -43246.3 -43195.7 -43143.7 -43090.2 -43035 -42978.2 -42919.8 -42859.5 -42797.5 -42733.6 -42667.8 -42600 -42530.1 -42458.1 -42383.8 -42307.3 -42228.4 -42147.1 -42063.2 -41976.7 -41887.5 -41795.4 -41700.4 -41602.3 -41501.1 -41396.7 -41288.8 -41177.4 -41062.3 -40943.4 -40820.6 -40693.6 -40562.4 -40426.7 -40286.5 -40141.4 -39991.3 -39836.1 -39675.4 -39509.1 -39336.9 -39158.7 -38974.1 -38782.9 -38584.8 -38379.5 -38166.7 -37946.2 -37717.6 -37480.5 -37234.6 -36979.5 -36714.9 -36440.3 -36155.3 -35859.6 -35552.6 -35233.8 -34902.9 -34559.3 -34202.5 -33831.9 -33447.1 -33047.4 -32632.3 -32201.2 -31753.5 -31288.7 -30806 -30304.9 -29784.8 -29245 -28685 -28104 -27501.7 -26877.3 -26230.3 -25560.3 -24866.7 -24149.2 -23407.3 -22640.7 -21849.3 -21032.8 -20191.2 -19324.6 -18433 -17516.7 -16576.1 -15611.7 -14624.1 -13614.3 -12582.9 -11531.3 -10460.5 -9372.06 -8267.36 -7148.08 -6016.01 -4873 -3721.04 -2562.19 -1398.56 -232.323 934.34 2099.23 3260.18 4415.05 5561.75 6698.28 7822.71 8933.24 10028.2 11105.9 12165.1 13204.4 14222.6 15218.9 16192.3 17142.1 18067.8 18968.9 19845.2 20696.4 21522.5 22323.5 23099.5 23850.8 24577.6 25280.3 25959.3 26614.9 27247.8 27858.5 28447.5 29015.4 29562.8 30090.2 30598.4 31087.9 31559.4 32013.5 32450.7 32871.7 33277 33667.3 34043.1 34404.9 34753.3 35088.8 35412 35723.2 36023 36311.8 36590.1 36858.3 37116.7 37365.8 37606 37837.6 38060.9 38276.4 38484.2 38684.8 38878.3 39065.1 39245.5 39419.7 39587.9 39750.5 39907.5 40059.2 40205.9 40347.7 40484.8 40617.4 40745.7 40869.8 40989.9 41106.1 41218.6 41327.5 41433 41535.1 41634.1 41729.9 41822.8 41912.8 42000.1 42084.6 42166.6 42246.1 42323.2 42398 42470.6 42540.9 42609.2 42675.5 42739.8 42802.2 42862.8 42921.7 42978.8 43034.2 43088.1 43140.4 43191.2 43240.5 43288.4 43334.9 43380.1 43424.1 43466.7 43508.2 43548.5 43587.6 43625.6 43662.6 43698.5 43733.4 43767.2 43800.2 43832.2 43863.2 43893.4 43922.8 43951.3 43978.9 44005.8 44031.9 44057.3 44081.9];

time = [0:2:length(dopplerBC)*2 - 2];

figure
plot(time, dopplerBC-dopplerNE, time, dopplerBC-dopplerNW, time, dopplerBC-dopplerSE, time, dopplerBC-dopplerSW, 'LineWidth', 2)
%plot(time, -dopplerBC, time, -dopplerNE, time, -dopplerNW, time, -dopplerSE, time, -dopplerSW, 'LineWidth', 2)
xlabel('Time (s)')
ylabel('Residual Doppler Shift (Hz)')
legend('UE 1', 'UE 2', 'UE 3', 'UE 4')
grid on